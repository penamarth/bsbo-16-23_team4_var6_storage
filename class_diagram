@startuml
scale 2
!define BOUNDED_CONTEXT(name) rectangle name <<Ограниченный контекст>>
!define AGGREGATE(name) rectangle name <<Агрегат>>

skinparam <<Ограниченный контекст>>{
    roundcorner 100
    PackageTitleAlignment 60
}
BOUNDED_CONTEXT("Внешняя_Система"){
    class ExternalSystem {
        - externalId: String
        + getExternalData()
    }

}


BOUNDED_CONTEXT("Процессы_склада") as RegisterContext {
    class StorageHouse
    interface iProcess

    class Acceptance
    class Order
    class Defragmentation
    class Checkout

    iProcess <|.. Acceptance
    iProcess <|.. Order
    iProcess <|.. Defragmentation
    iProcess <|.. Checkout
    StorageHouse -- iProcess

    AGGREGATE("Элементы") {
        class Batch
        class Item
        Item <|--up Batch
    }

    Acceptance o-- Batch
    Order o-- Batch


}
' === Документооборот ===
BOUNDED_CONTEXT("Документооборот") {
    AGGREGATE("Документы"){
    interface iDoc

    class DocWorks
    class AcceptanceDoc
    class OrderDoc
    class DefragmentationDoc
    class CheckoutDoc
    
    iDoc <|.. AcceptanceDoc
    iDoc <|.. OrderDoc
    iDoc <|.. DefragmentationDoc
    iDoc <|.. CheckoutDoc
    }

    AGGREGATE("Храненилище_расположения"){
        interface iReposDoc
        class docRepos
        iReposDoc <|-- docRepos
    }
    DocWorks --> iDoc
    DocWorks --> iReposDoc

}

BOUNDED_CONTEXT("Расположение_элементов") {
    AGGREGATE("Расположение") {
        interface iStorage

        class StockCell
        class StorageComposit
        class StockShelf
        class StockRoom
        class StockRack

        iStorage <|.. StockCell
        iStorage <|.. StorageComposit
        StorageComposit o-up-> iStorage
        StorageComposit <|---down StockShelf
        StorageComposit <|---down StockRoom
        StorageComposit <|---down StockRack
    }
    AGGREGATE("Храненилище_расположения") {
        interface iReposStor
        class storRepos
        iReposStor <|-- storRepos

   }
}

StorageHouse -left-> ExternalSystem
iProcess -up--> DocWorks
iProcess --> iStorage
iStorage --> iReposStor
@enduml
